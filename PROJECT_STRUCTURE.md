# GPM-Login Python Agent - Project Structure

## Overview
This is a comprehensive Python agent for GPM-Login browser profile management. The agent provides a complete API client, Selenium integration, automation helpers, and batch processing capabilities.

## Project Structure
```
gpm_agent/
├── gpm_client.py          # Main GPM-Login API client
├── gpm_selenium.py        # Selenium WebDriver integration
├── utils.py               # Utility functions and helpers
├── examples.py            # Basic usage examples
├── test_agent.py          # Test suite for the agent
├── batch_automation.py    # Batch automation examples
├── setup.py               # Setup and installation script
├── requirements.txt       # Python dependencies
├── README.md              # Comprehensive documentation
├── PROJECT_STRUCTURE.md   # This file
└── config_example.py      # Example configuration (generated by setup.py)
```

## Core Components

### 1. GPMClient (`gpm_client.py`)
- **Purpose**: Main API client for GPM-Login
- **Key Features**:
  - Complete API coverage (list, create, start, stop, delete profiles)
  - Profile search and filtering
  - Context manager for automatic profile management
  - Error handling and logging
  - Support for all proxy types
  - Default profile creation helpers

### 2. GPMSeleniumDriver (`gmp_selenium.py`)
- **Purpose**: Selenium WebDriver integration
- **Key Features**:
  - Automatic browser configuration from GPM profiles
  - Anti-detection measures built-in
  - Context manager for resource cleanup
  - Support for Chrome and Firefox profiles
  - Helper functions for common automation tasks

### 3. Automation Helper (`gpm_selenium.py`)
- **Purpose**: Batch automation and task management
- **Key Features**:
  - Single task execution with automatic cleanup
  - Batch processing across multiple profiles
  - Parallel execution with concurrency control
  - Error handling and result collection
  - Configurable delays between tasks

### 4. Utilities (`utils.py`)
- **Purpose**: Common helper functions
- **Key Features**:
  - Logging configuration
  - JSON report generation
  - User agent generation
  - Proxy format validation
  - Profile batch creation
  - System resource monitoring
  - Duration estimation

## Usage Patterns

### 1. Basic Profile Management
```python
from gpm_client import GPMClient

client = GPMClient()
profiles = client.list_profiles()
new_profile = client.create_default_profile("My Profile")
```

### 2. Selenium Automation
```python
from gpm_client import GPMClient
from gpm_selenium import GPMSeleniumDriver

client = GPMClient()
with GPMSeleniumDriver(client) as gpm_driver:
    driver = gpm_driver.create_driver_from_profile(profile_id)
    driver.get("https://example.com")
```

### 3. Batch Automation
```python
from gpm_client import GPMClient
from gpm_selenium import GPMAutomationHelper

client = GPMClient()
helper = GPMAutomationHelper(client)

def my_task(driver, url):
    driver.get(url)
    return {"title": driver.title}

result = helper.run_automation_task(profile_id, my_task, "https://google.com")
```

### 4. Context Managers
```python
from gmp_client import GPMClient, GPMProfileSession

client = GPMClient()
with GPMProfileSession(client, profile_id) as session_info:
    # Profile automatically started
    browser_data = session_info['data']
    # Do automation work here
    # Profile automatically stopped when exiting
```

## Configuration

### Environment Variables
- `GPM_BASE_URL`: GPM-Login API base URL (default: http://127.0.0.1:19995)
- `GPM_TIMEOUT`: Request timeout in seconds (default: 30)

### Configuration File
Copy `config_example.py` to `config.py` and modify settings:
```python
GPM_BASE_URL = "http://127.0.0.1:19995"
DEFAULT_BROWSER_CORE = "chromium"
DEFAULT_OS = "Windows 11"
```

## Dependencies

### Core Dependencies
- `requests`: HTTP client for API communication
- `selenium`: WebDriver automation framework
- `undetected-chromedriver`: Enhanced Chrome driver with anti-detection

### Optional Dependencies
- `psutil`: System resource monitoring
- `threading`: Parallel automation support

## API Coverage

### Profile Management
- ✅ List profiles (`GET /api/v3/profiles`)
- ✅ Get profile (`GET /api/v3/profile/{id}`)
- ✅ Create profile (`POST /api/v3/profiles/create`)
- ✅ Start profile (`GET /api/v3/profiles/start/{id}`)
- ✅ Stop profile (`GET /api/v3/profiles/stop/{id}`)
- ✅ Delete profile (`DELETE /api/v3/profiles/{id}`)

### Profile Features
- ✅ Search and filtering
- ✅ Sorting options
- ✅ Pagination support
- ✅ Group management
- ✅ Proxy configurations
- ✅ Browser settings
- ✅ Anti-detection features

## Examples and Testing

### Running Examples
```bash
# Basic examples
python examples.py

# Batch automation
python batch_automation.py

# Test suite
python test_agent.py

# Setup and installation
python setup.py
```

### Example Scripts
1. **examples.py**: Basic operations, profile sessions, search/manage, proxy configs
2. **batch_automation.py**: Parallel processing, report generation, cleanup
3. **test_agent.py**: Comprehensive test suite for all features

## Selenium Integration Features

### Automatic Configuration
- Browser path detection from GPM profile
- Driver path configuration
- Remote debugging port setup
- Anti-detection measures

### Supported Browsers
- Chrome/Chromium profiles
- Firefox profiles (with appropriate driver)

### Anti-Detection Features
- Removes webdriver property
- Disables automation indicators
- Uses real browser profiles from GPM
- Maintains consistent fingerprints

## Error Handling

### Exception Types
- `GPMClientError`: API-specific errors
- `requests.RequestException`: Network/HTTP errors
- `selenium.WebDriverException`: WebDriver errors

### Error Recovery
- Automatic profile cleanup on failure
- Graceful error handling in batch operations
- Detailed error logging and reporting

## Best Practices

### Resource Management
1. Always use context managers for automatic cleanup
2. Stop profiles when done to free resources
3. Monitor system resources during batch operations

### Automation Safety
1. Add random delays between actions
2. Use different profiles for different tasks
3. Rotate proxies for better anonymity
4. Handle errors gracefully

### Performance Optimization
1. Use parallel processing for batch operations
2. Limit concurrent profiles based on system resources
3. Reuse profiles when possible
4. Monitor and log performance metrics

## Troubleshooting

### Common Issues
1. **GPM-Login not accessible**: Check if GPM-Login is running and API is enabled
2. **Import errors**: Run `python setup.py` to install dependencies
3. **Profile start failures**: Check proxy configuration and system resources
4. **WebDriver errors**: Verify browser and driver compatibility

### Debug Mode
Enable debug logging for detailed information:
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## Future Enhancements

### Planned Features
- Group management API coverage
- Profile template system
- Advanced automation scenarios
- Performance monitoring dashboard
- Configuration management UI

### Extension Points
- Custom automation task templates
- Plugin system for additional browsers
- Integration with other automation frameworks
- Advanced reporting and analytics

## Contributing

### Development Setup
1. Clone the repository
2. Run `python setup.py` to install dependencies
3. Run `python test_agent.py` to verify installation
4. Create feature branches for new functionality

### Code Style
- Follow PEP 8 guidelines
- Use type hints where possible
- Add comprehensive docstrings
- Write tests for new features

## License and Support

This project is provided as-is for educational and automation purposes. Please ensure compliance with websites' terms of service when using for automation.

For issues and feature requests, please check the documentation and examples first, then create an issue with detailed information about the problem.

---

**Created**: July 16, 2025  
**Version**: 1.0.0  
**Python**: 3.7+  
**GPM-Login**: API v3 compatible  
**Author**: mrlaw74
